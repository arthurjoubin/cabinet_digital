{% extends 'base.html' %}
{% load static %}

{% block title %}
Actualités des logiciels pour experts-comptables et PME - Cabinet Digital
{% endblock %}

{% block meta_description %}
<meta name="description" content="Découvrez les dernières actualités et tendances des logiciels pour experts-comptables et PME. Restez informé des nouveautés et des évolutions du marché.">
<meta property="og:title" content="Actualités des logiciels pour experts-comptables et PME - Cabinet Digital">
<meta property="og:description" content="Découvrez les dernières actualités et tendances des logiciels pour experts-comptables et PME. Restez informé des nouveautés et des évolutions du marché.">
<meta property="og:type" content="website">
<meta property="og:image" content="{% static 'cabinet_logos/OG_image_cabinetdigital.png' %}">
<meta property="og:site_name" content="Cabinet Digital">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-gradient-to-br from-gray-50 to-white border-b border-gray-300">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
    {% include 'partials/breadcrumb.html' %}
    
    <div class="text-center">
      <h1 class="text-2xl sm:text-3xl font-bold mb-3">
        Dernières
        <span class="bg-black text-white px-3 py-1 rounded-md inline-block">
          actualités
        </span>
        des logiciels
      </h1>
      <p class="text-base sm:text-lg text-gray-600 max-w-3xl mx-auto">
        Découvrez les dernières actualités des logiciels pour experts-comptables et PME.
      </p>
    </div>
  </div>
</section>

<!-- Main Content -->
<main class="bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 py-6">

    <!-- Actualités count centered -->
    <section class="mb-6">
      <div class="text-center mb-6">
        <div class="inline-flex items-center gap-2 bg-gray-100 text-gray-700 px-4 py-2 rounded-full border border-gray-200">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 01-2-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
          </svg>
          <span class="font-medium">{{ total_actualites }} actualité{% if total_actualites > 1 %}s{% endif %} en {{ current_year }}</span>
        </div>
      </div>
      
      <!-- Tags Filter -->
      {% if tags %}
      <div class="bg-white rounded-xl border border-gray-200 p-4 shadow-sm">
        <div class="flex flex-wrap gap-2 justify-center">
          <!-- All tag -->
          <a href="{% url 'actualites' %}" 
             class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 border {% if not selected_tag %}bg-black text-white border-black{% else %}bg-white text-gray-700 border-gray-200 hover:border-gray-300 hover:bg-gray-50{% endif %}">
            Tous
          </a>
          
          <!-- Individual tags -->
          {% for tag in tags %}
          <a href="?tag={{ tag.slug }}" 
             class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 border {% if selected_tag == tag.slug %}border-2 shadow-md{% else %}{% endif %}"
             style="background-color: {% if selected_tag == tag.slug %}{% if tag.color %}{{ tag.color }}{% else %}#1e40af{% endif %}{% else %}{% if tag.color %}{{ tag.color }}20{% else %}#EBF5FF{% endif %}{% endif %}; 
                     color: {% if selected_tag == tag.slug %}white{% else %}{% if tag.color %}{{ tag.color }}{% else %}#1e40af{% endif %}{% endif %};
                     border-color: {% if tag.color %}{{ tag.color }}{% else %}#1e40af{% endif %};
                     {% if selected_tag == tag.slug %}font-weight: 600;{% endif %}">
            {{ tag.name }}
          </a>
          {% endfor %}
        </div>
      </div>
      {% endif %}
    </section>

    <!-- News Grid -->
    <section id="news-list-content" aria-label="Liste des actualités">
      {% if actualites %}
        <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {% for actualite in actualites %}
            <article class="bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-md transition-all duration-200 flex flex-col">
              <a href="{% url 'actualite_detail' actualite.slug %}" class="flex flex-col h-full p-4">
                <!-- Date and Tags Header -->
                <div class="flex items-center justify-between mb-2">
                  <time class="text-xs text-gray-500">{{ actualite.pub_date|date:"d M Y" }}</time>
                  <div class="flex flex-wrap gap-1">
                    {% for tag in actualite.tags.all|slice:":2" %}
                    <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium rounded-full" 
                          style="background-color: {% if tag.color %}{{ tag.color }}20{% else %}#EBF5FF{% endif %}; 
                                 color: {% if tag.color %}{{ tag.color }}{% else %}#1e40af{% endif %};">
                      {{ tag.name }}
                    </span>
                    {% endfor %}
                    {% if actualite.tags.all|length > 2 %}
                    <span class="text-xs text-gray-400">+{{ actualite.tags.all|length|add:"-2" }}</span>
                    {% endif %}
                  </div>
                </div>
                
                <!-- Title -->
                <h2 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2 hover:text-sky-600 transition-colors">
                  {{ actualite.title }}
                </h2>
                

                
                <!-- Read more -->
                <div class="flex items-center text-sky-600 text-sm font-medium group">
                  <span>Lire la suite</span>
                  <svg class="w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </div>
              </a>
            </article>
          {% endfor %}
        </div>
      {% else %}
        <!-- Empty State -->
        <div class="text-center py-12 bg-white rounded-xl border border-gray-200">
          <div class="max-w-md mx-auto px-4">
            <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
            </svg>
            <h3 class="text-lg font-semibold text-gray-900 mb-2">Aucune actualité trouvée</h3>
            <p class="text-gray-600 mb-4">Aucune actualité ne correspond à vos critères de recherche.</p>
            <a href="{% url 'actualites' %}" 
               class="inline-flex items-center gap-2 px-4 py-2 bg-black text-white text-sm font-medium rounded-md hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
              </svg>
              Réinitialiser les filtres
            </a>
          </div>
        </div>
      {% endif %}
      
      <!-- Pagination -->
      {% if is_paginated %}
        <nav aria-label="Navigation des pages" class="mt-8">
          {% include "partials/pagination.html" with search_param="search" search_query=search_query filter_param="tag" filter_value=selected_tag %}
        </nav>
      {% endif %}
    </section>
  </div>
</main>
{% endblock %}
